#!/bin/sh
exec>>/dev/null 2>&1

flag=''
oflag=''

while true
do
	gw=''
	gw=`ip route | grep default | awk '{print $3}'`

	ping -W 2 -c 1 $gw
	status=$?
	if [ $status -eq 0 ] && [ "$flag" = "0" ];then
		flag=1
		echo "none" > /sys/class/leds/gl-s200:blue/trigger
		echo "none" > /sys/class/leds/gl-s200:green/trigger
		echo "none" > /sys/class/leds/gl-s200:orange/trigger
		echo 0 > /sys/class/leds/gl-s200:blue/brightness
		echo 0 > /sys/class/leds/gl-s200:orange/brightness
		echo 1 > /sys/class/leds/gl-s200:green/brightness
	elif [ "$status" != "0" ] && [ "$flag" = "1" ];then
		flag=0
		echo "none" > /sys/class/leds/gl-s200:blue/trigger
		echo "none" > /sys/class/leds/gl-s200:orange/trigger
		echo 0 > /sys/class/leds/gl-s200:blue/brightness
		echo 0 > /sys/class/leds/gl-s200:orange/brightness
		echo 1 > /sys/class/leds/gl-s200:green/brightness
		echo "timer" > /sys/class/leds/gl-s200:green/trigger
	elif [ "$flag" = "" ];then
		if [ $status -eq 0 ];then
			flag=1
			echo "none" > /sys/class/leds/gl-s200:blue/trigger
			echo "none" > /sys/class/leds/gl-s200:green/trigger
			echo "none" > /sys/class/leds/gl-s200:orange/trigger
			echo 0 > /sys/class/leds/gl-s200:blue/brightness
			echo 0 > /sys/class/leds/gl-s200:orange/brightness
			echo 1 > /sys/class/leds/gl-s200:green/brightness
		else
			flag=0
			echo "none" > /sys/class/leds/gl-s200:blue/trigger
			echo "none" > /sys/class/leds/gl-s200:orange/trigger
			echo 0 > /sys/class/leds/gl-s200:blue/brightness
			echo 0 > /sys/class/leds/gl-s200:orange/brightness
			echo 1 > /sys/class/leds/gl-s200:green/brightness
			echo "timer" > /sys/class/leds/gl-s200:green/trigger
		fi
	fi

	[ "$oflag" = "$flag" ] && {
		sleep 5
		continue
	}

	oflag=$flag
done
